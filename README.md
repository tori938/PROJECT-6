## **Проект 6. Сегментация Клиентов Онлайн Магазина Подарков**

## Оглавление
1. [Описание Проекта](README.md#описание-проекта)
2. [Основные Задачи](README.md#основные-задачи)
3. [Краткая Информация о Данных](README.md#краткая-информация-о-данных)
4. [Этапы Работы над Проектом](README.md#этапы-работы-над-проектом)
5. [Результат](README.md#результат)


### Описание Проекта

Маркетинг — неотъемлемая часть любого бизнеса. Для повышения прибыли компании важно понимать своего клиента, его пожелания и предпочтения. С появлением электронной коммерции, или онлайн-продаж, стало намного проще собирать данные о клиентах, анализировать их, находить закономерности и реализовывать маркетинговые кампании.

Большинство интернет-магазинов используют инструменты веб-аналитики, чтобы отслеживать просмотры страниц, количество и поведение посетителей и коэффициент отказов. Но отчёта из Google Analytics или аналогичной системы может быть недостаточно для полного понимания того, как клиенты взаимодействуют с сайтом. Компаниям важно иметь возможность быстро и точно реагировать на перемены в поведении клиентов, создавая инструменты, которые обнаруживают эти изменения практически в режиме реального времени.

Машинное обучение помогает поисковой системе анализировать огромное количество данных о посетителях платформы, узнавать модели поведения профессиональных покупателей, определять категорию клиентов (например, лояльные/перспективные/новички/спящие/ушедшие) и выбирать правильную стратегию взаимодействия с ними.

Стоит также отметить, что компании, использующие машинное обучение на своих платформах электронной коммерции, могут постоянно повышать эффективность бизнес-процессов: настраивать товарную выборку персонально для каждого покупателя и предлагать выгодную цену в соответствии с бюджетом клиента и т. д. Эта задача относится к категории построения рекомендательных систем, речь о которых пойдёт в следующем разделе нашего курса.

> Как правило, наборы данных для электронной коммерции являются частной собственностью и, следовательно, их трудно найти среди общедоступных данных. Однако [The UCI Machine Learning Repository](http://archive.ics.uci.edu/ml/index.php)  создал набор данных, содержащий фактические транзакции за 2010 и 2011 годы. С ним нам как раз и предлагается поработать в этом кейсе. 

> В нашем распоряжении будет набор данных, который содержит все транзакции, произошедшие в период с 01/12/2010 по 09/12/2011 для базирующейся в Великобритании компании, занимающейся онлайн-розничной торговлей. Компания в основном продает уникальные подарки на все случаи жизни. Многие клиенты компании являются оптовиками.

:arrow_up:[to Table of Contents](README.md#оглавление)


### Основные Задачи

*Бизнес-задача:* произвести сегментацию существующих клиентов, проинтерпретировать эти сегменты и определить стратегию взаимодействия с ними.

*Техническая задача:* построить модель кластеризации клиентов на основе их покупательской способности, частоты заказов и срока давности последней покупки, определить профиль каждого из кластеров.

_Основные Задачи_:

  - Произвести предобработку исходного набора данных о транзакциях.
  - Провести разведывательный анализ данных и выявить основные закономерности.
  - Сформировать набор данных о характеристиках каждого из уникальных клиентов.
  - Построить несколько моделей машинного обучения, решающих задачу кластеризации клиентов, определить количество кластеров и проинтерпретировать их.
  - Спроектировать процесс предсказания категории интересов клиента и протестировать вашу модель на новых клиентах.

:arrow_up:[to Table of Contents](README.md#оглавление)


### Краткая Информация о Данных

Данные представляют собой таблицу в формате CSV (добавлено в репозиторий в виде zip-файла), в каждой строке которой содержится информация об уникальной транзакции.

Признаки, описывающие каждую транзакцию:

* InvoiceNo — номер счёта-фактуры (уникальный номинальный шестизначный номер, присваиваемый каждой транзакции; буква "C" в начале кода указывает на отмену транзакции);
* StockCode — код товара (уникальное пятизначное целое число, присваиваемое каждому отдельному товару);
* Description — название товара;
* Quantity — количество каждого товара за транзакцию;
* InvoiceDate — дата и время выставления счёта/проведения транзакции;
* UnitPrice — цена за единицу товара в фунтах стерлингов;
* CustomerID — идентификатор клиента (уникальный пятизначный номер, однозначно присваиваемый каждому клиенту);
* Country — название страны, в которой проживает клиент.

:arrow_up:[to Table of Contents](README.md#оглавление)


### Этапы Работы над Проектом

1. Описательный Анализ Данных:
   - знакомство с данными
   - базовые статистический анализ признаков

2. Обработка и Преобразование Данных:
   - работа с пропусками и дубликатами
   - удаление признаков
   - создание признаков

3. Разведывательный Анализ Данных:
   - Визуализация Данных:
      - исследовать данные
      - нащупать первые закономерности и выдвинуть гипотезы

4. Очистка и Отбор Признаков:
   - преобразование и удаление признаков: построение RFM (Recency, Frequency, Monetary)
   - работа с выбросами: поиск RFM-выбросов
   - масштабирование признаков с помощью Standard Scaler

5. Построение Моделей Кластеризации и Анализ Качества с Помощью Внутренних Мер
   - снижение размерности через Principal Component Analysis:
     - K-Means, EM-Algorithm, Agglomerative Clustering, DBScan + Silhouette Score, Calinski-Harabasz, Davies-Bouldin
   - снижение размерности через t-distributed stochastic neighbor embedding > отбор гиперпараметров через Optuna
     - K-Means, EM-Algorithm, Agglomerative Clustering + Silhouette Score, Calinski-Harabasz, Davies-Bouldin
       
6. Построение Моделей Классификации и Анализ Качества с F1-Score
  - разделение данных для модели: выделение обучаемой и тестовой частей
  - отбор гиперпараметров
  - построение моделей Random Forest и Gradient Boosting

:arrow_up:[to Table of Contents](README.md#оглавление)


### Результат

Лучшие результаты внутренние мер на данных с PCA с 3 кластерами, лучшие результаты внутренние мер на данных с t-SNE от 5-7 кластеров, финальная модель построена на 7 кластеров, что больше соответствуют группам, предложенным RFM.

Результаты моделей классификации:

    - Random Forest: F1-Score = 0.990
    - Gradient Boosting: F1-Score = 0.991

<img width="978" alt="Screenshot 2025-01-22 at 22 31 50" src="https://github.com/user-attachments/assets/5c4bb7aa-4164-4640-9c5c-fb745e9160c4" />

:arrow_up:[to Table of Contents](README.md#оглавление)
